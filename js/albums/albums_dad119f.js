define("js/albums/albums",function(require){var A=require("js/init");console.log($),A.controller("albumsCtrl",function($scope,$interval,$element,$timeout,$http){var lock=!0;$scope.ToRight=function(){if(lock){lock=!1;var oldIndex=0;$(".moveUl").animate({left:-290},1e3,function(){var dom=$(".moveUl li").eq(oldIndex).remove();$(this).css("left",0).append(dom),lock=!0})}},$scope.ToLeft=function(){if(lock){lock=!1;var oldIndex=4,dom=$(".moveUl li").eq(oldIndex).remove();$(".moveUl").prepend(dom),$(".moveUl").css("left",-290),$(".moveUl").animate({left:0},1e3,function(){$(this).css("left",0),lock=!0})}};var timer=$interval(function(){$scope.ToRight()},2e3);$element.find($(".lunbo")).hover(function(){$interval.cancel(timer)},function(){timer=$interval(function(){$scope.ToRight()},2e3)}),$timeout(function(){$("[data-toggle='tooltip']").tooltip()},100),$scope.lock=!0,$scope.iPage=1,$scope.showLoading=!0,$scope.getList=function($http){$http.get("action/getPics.php?cpage="+$scope.iPage).success(function(res){res.length&&($scope.getImg(res),$scope.lock=!0)})},$scope.getShort=function(){for(var index=0,ih=$(".pubuliu ul > li").eq(index).height(),i=1;i<$(".pubuliu ul > li").length;i++)$(".pubuliu ul > li").eq(i).height()<ih&&(index=i,ih=$(".pubuliu ul > li").eq(index).height());return index},$scope.getTop=function(obj){var iTop=0;return obj&&(iTop=obj.offsetTop),iTop},window.onscroll=function(){var _index=$scope.getShort(),oLi=$(".pubuliu ul > li")[_index];$scope.getTop(oLi)+oLi.offsetHeight<document.documentElement.clientHeight+$(document).scrollTop()&&$scope.lock&&($scope.lock=!1,$scope.iPage++,$scope.getList($http))},$scope.getImg=function(res){for(var i=0;i<res.length;i++){$scope.num=parseInt(3e3*Math.random());var html=$('<div class="boxWP"><div class="imgDiv"><img src="'+res[i].preview+'"><div><h3>Orange carrot smoothie</h3><p>'+res[i].title+'</p><a href="">Read More</a></div></div><div class="bottom"><span class="btn btn-primary btn-sm">Image & Text</span><span class="midText"><i class="glyphicon glyphicon-time"></i>&emsp;<i class="txt">MAY 5</i></span><span class="like" ng-click="dianzan()"><i class="glyphicon glyphicon-heart"></i>&emsp;<span> '+$scope.num+"</span></span></div></div>");html.find(".imgDiv img").eq(i).width(306),html.find(".imgDiv img").eq(i).height(res[i].height*(306/res[i].width));var idx=$scope.getShort();$(".pubuliu ul > li").eq(idx).append(html),$scope.showLoading=!1}$(".boxWP .bottom .like").click(function(e){if("rgb(255, 0, 0)"===$(e.currentTarget).find("i").css("color"));else{var num=+$(e.currentTarget).find("span").html()+1;$(e.currentTarget).find("span").html(num),$(e.currentTarget).find("i").css("color","red")}})},$scope.getList($http)})});