### vim介绍

主要是结合ideavim插件介绍

vim有三个模式，分别为普通（正常）模式、插入模式以及命令模式。

- 普通模式：一般用于浏览文件，也包括一些复制、粘贴、除等操作。
- 插入模式：主要用来输入、修改、删除字符，此时的操作，除了不能用鼠标外，与我们日常在编辑器中操作无异。普通模式下，通过`i`等命令进入插入模式。
- 命令模式：用以执行一些输入并执行一些vim或插件提供的指令。在普通模式下通过输入`:`后，可以发现，屏幕的右下角会出现`:`，此时便进入了命令模式。本文中使用`：`开头的命令，便可视为输入`:`进入命令模式后，输入后面的字符，执行命令。

普通模式下，`vim`的命令主要分为以下三种：

1. 动作，用以移动光标，或者定义操作的范围；比如：
   1. `h`：定义操作范围为一格，单独使用时，向左移动光标一格。
   2. `w`：定义操作范围为一个单词，移动光标到下一个单词首部。
2. 操作，这种命令需要在后面接表示操作范围的指令；
   1. `d`，删除，后接表示一个单词操作范围的`w`，即`dw`时，表示删除到当前词尾。
   2. `c`，修改，后接表示一个单词操作范围的`w`，即`cw`时，表示修改当前单词。(编辑器行为表现为，删除到当前词尾，同时进入插入模式)。
3. 命令，直接执行的命令，其中一部分，在执行命令后，直接进入编辑模式；比如：
   1. `D`，删除至行末。
   2. `I`，到行首进入插入模式。 我们的使用方式主要也是三种：命令、动作、操作+动作。 此外，在**动作**类的命令前，加上`number`为可选项，可实现`重复n次`的效果：
4. `[number] + h/j/k/l` 向`左/下/上/右`移动`number`个字符。比如，'2j'，向下移动光标2个字符。
5. 依旧使用`d`和`w`来举例，`d`是删除，`w`是单词，`dw`代表删除一个单词，`d2w`代表删除两个单词。后面的命令，大多都可应用此种形式组合使用，养成这种`操作 + [次数] + 范围`的思维模式，举一反三，便可发挥最大功效。

####  行内的移动

`word`和`string`的区别：

`string`仅以**空格**分开；

`word`以**字母数字以外的字符**分开。

基于此的移动命令

- `w` 下一个单词开头
- `e` 当前或下一个单词结尾
- `b` 当前或上一个单词开头
- `ge` 上一个单词的结尾
- `W` 下一个字符串的开头
- `E` 当前或下一个字符串结尾
- `B` 当前或上一个字符串的开头
- `GE` 上一个字符串的结尾

其他

- `0` 移动到当前行行首
- `^` 移动到当前行的第一个非空字符
- `$` 移动到当前行尾

#### 行内的匹配移动

- `f+单个字符`：在本行内向右移动到指定字符
- `F+单个字符`：在本行内向左移动到指定字符
- `t+单个字符`：在本行内向右移动到指定字符的前一个字符
- `T+单个字符`：在本行内向左移动到指定字符的前一个字符

#### 其他的匹配移动

- `%`: 在“( )”、“[ ]”、“{ }”类符号的首尾间切换
- `*` 和 `#`: 匹配光标当前所在的单词，移动光标到下一个（或上一个）匹配单词（*是下一个，#是上一个）。

#### 多行的移动

- `gg` 移动到文本第一行行首
- `G` 移动到文本末行行首
- `[n] + gg/G` 跳转到第`n`行，常用。

#### 滚动与翻页

- `ctrl-d/u`：前进/后退半页
- `ctrl+e`：上滚一行
- `ctrl+y`：下滚一行
- `zt`：使光标所在位置移动到屏幕的顶部（所有内容做位移）
- `zz`：使光标所在位置移动到屏幕的中央（所有内容做位移）
- `zb`：使光标所在位置移动到屏幕的底部（所有内容做位移）

#### Mark

- `m+[a~z]` ：在当前光标做标记，如ma
- `'+[mark]`：光标返回指定标记所在的行，如`'a`，则光标返回到标记`a`所在行首
- `ctrl+o`：跳转回光标前一个位置
- 建议结合命令模式下如下两个命令，可获得更好体验：
  - `:marks`：显示全部mark
  - `:delmarks [mark]`：删除指定mark

#### 进入插入模式

##### 在不同位置进入插入模式

- `i`：在光标前插入字符
- `I`：在行首插入字符
- `a`：在光标后插入字符
- `A`：在行尾插入字符
- `o`：在光标下发插入空行
- `O`：在光标上方插入空行

##### 使用修改命令进入插入模式

- `c`：修改，后面需要接范围
- `c+w`：删除光标位置单词，并进入插入模式
- `c+l / s`：删除光标位置字符，并进入插入模式
- `c+c / S`：删除光标所在行，并进入插入模式
- `c+$ / C`：删除光标位置到行尾的字符，并进入插入模式
- `r`： 替换当前字符。
- `R`：（进入replace模式）持续替换光标所在字符，直到使用ESC退出替换模式。

#### 删除

- `x`： 删除当前位置或下一个位置的字符。
- `d`：删除，属于动作指令，后面需要加操作类指令。比如如下命令：
  - `de`：删除到当前单词结尾。
  - `dw`：删除到下一个单词开始。
  - 注意，此处与`de`的区别在于，`dw`会删除两个单词之间的空格。
  - `d0`：删除至行首。
  - `d$ / D`：删除至行尾。
- `da[`：删除[ ]整个块，包含符号本身；
- `di[`：删除[ ]块，不包含符号本身；
- `da/di +` ' " { ( 等，也与接[类似，删除整个区块。唯一需要注意的，"和'仅仅在行内。
- `dt[x]`：在本行，删除到[x]。比如，`dt"`删除到双引号，`dtf`，删除到字母`f`。 `d/foo`：在全文， 删除到 “foo” 。

#### 剪切

剪切操作其实就是删除。也就是`d`。删除的内容，默认会存放到剪切板中。也就相当于进行了剪切。

#### 进阶操作符

从这里大家可以看出，`i`和`a`的作用比较特殊，代表与区块相关的某种操作。区别就在于，`i`不包含区块边界符号。`a`包含。这两个操作符很重要，在后面的复制操作中还会用到。此外还有`t`，`/`。

`i`：区块，不包含边界。`a`：区块，包含边界。`t`："to"，本行到哪里。`/`：接匹配，全文到哪里。

#### 粘贴

- `p`：粘贴到光标后，或下一行。
- `P`：粘贴到光标前，或前一行。

为什么会有光标前后或上下一行两种情况呢？是因为我们复制或剪切的内容有可能是字符串或者整行：

- 当复制内容为字符串时，粘贴到光标前/后。
- 当复制内容为整行时，粘贴到上/下一行。

#### 复制

y复制，属于操作，后面需要接动作来标识复制的范围。比如：

- `yw`：复制到当前单词结尾。
- `ye`：从当前位置复制到本单词的最后一个字符。
- `y$`：复制到当前行尾。
- `yy`或`Y`：复制当前行。
- `nyy`：复制从光标所在行起的n行，注意n在最前面。

当然也可以结合操作符`i`和`/`来进行操作：

- `yi"`：复制两个引号之间
- `y/[x]`：复制到x。

#### 寄存器

`:reg`：查看各个剪切板里的内容。 `"[n]y`：复制到寄存器`n`中。`"[n]p`：粘贴寄存器`n`中的内容。

 `+`号寄存器比较特殊，是**系统剪切板**，可以用于与系统其他应用互动：

- `"+y`，将内容复制到系统剪切板，`ctrl＋v`将其粘贴到其他应用中。
- `"+p`，将其他应用中复制的内容，粘贴到vim中。

0号寄存器是y命令默认使用的，所以如果在复制之后进行了一些剪切操作，可以使用`"0y`进行粘贴

##### [更多](https://harttle.land/2016/07/25/vim-registers.html)

#### 可视模式

`v`：进入可视模式。`V`：进入行选择模式。`Crtl + v`：进入块选择模式。

进入可视模式后，可以通过之前的移动操作，来进行选择。比如：`hjkl`：前后左右选择。`$`：选择到行尾。`i"`：选择两个引号之间。

选择后，可以使用

- `d`进行删除/剪切，
- `y`进行复制。

#### 撤销

- `u`：撤销前一个动作

#### 查找与替换

##### 查找

- `/`： 查找，此时Terminal左下角会出现`/`，在后面输入想要查找的内容，回车即可。
- `?`：反向查找，同样道理，左下角会出现`?`。
- `/[search]\c`：忽略大小写。比如：`/test\c`，查找test，忽略大小写
- `n`： 下一个匹配
- `N`： 前一个匹配

如何设置高亮：

在`.ideavim`中添加：

```
" " 当输入查找命令时，再启用高亮
noremap n :set hlsearch<cr>n
noremap N :set hlsearch<cr>N
noremap / :set hlsearch<cr>/
noremap ? :set hlsearch<cr>?
noremap * *:set hlsearch<cr>

" " ctrl+M 取消高亮
nnoremap <C-M> :set nohlsearch<cr>
```

##### 替换

`:s`（substitute）命令用来查找并替换字符串。语法如下：

```
:{作用范围}s/{目标}/{替换}/{替换标志}
```

例如`:%s/foo/bar/g`会在全局范围(`%`)查找`foo`并替换为`bar`，所有出现都会被替换（`g`）。

##### 作用范围

作用范围分为当前行、全文、选区等等。

当前行：

```
:s/foo/bar/g
```

全文：

```
:%s/foo/bar/g
```

选区，在Visual模式下选择区域后输入`:`，Vim即可自动补全为 `:'<,'>`。

```
:'<,'>s/foo/bar/g
```

2-11行：

```
:5,12s/foo/bar/g
```

当前行`.`与接下来两行`+2`：

```
:.,+2s/foo/bar/g
```

##### 替换标志

上文中命令结尾的`g`即是替换标志之一，表示全局`global`替换（即替换目标的所有出现）。 还有很多其他有用的替换标志：

空替换标志表示只替换从光标位置开始，目标的第一次出现：

```
:%s/foo/bar
```

`i`表示大小写不敏感查找，`I`表示大小写敏感：

```
:%s/foo/bar/i
# 等效于模式中的\c（不敏感）或\C（敏感）
:%s/foo\c/bar
```

`c`表示需要确认，例如全局查找`"foo"`替换为`"bar"`并且需要确认：

```
:%s/foo/bar/gc
```

回车后Vim会将光标移动到每一次`"foo"`出现的位置，并提示

```
replace with bar (y/n/a/q/l/^E/^Y)?
```

按下`y`表示替换，`n`表示不替换，`a`表示替换所有，`q`表示退出查找模式， `l`表示替换当前位置并退出。